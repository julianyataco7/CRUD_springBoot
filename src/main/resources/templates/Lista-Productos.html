<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>Inventario</title>
    </head>
    <body>
        <h1>Productos en inventario</h1>
        <button><a th:href="@{/productos/agregarProducto}">Agregar producto</a></button>
        <ul>
            <li th:each="producto : ${listaProductos}">
                <a th:href="@{/productos/{id}(id=${producto.idProducto})}" th:text="${producto.nombre}"></a> -
                <span th:text="${producto.stock}"></span> stock
                <span th:text="${producto.precio}"></span> soles

                <!-- Boton para abrir el modal no lo olvides  -->
				<button type="button" 
				    th:attr="onclick='abrirModalActualizar(' + ${producto.idProducto} + ', \'' + ${producto.nombre} + '\', ' + ${producto.precio} + ', ' + ${producto.stock} + ');'">
				    Actualizar
				</button>

                <!-- Boton que va a eliminar los productos -->
                <form th:action="@{/productos/eliminar}" method="post" style="display:inline;">
                    <input type="hidden" name="idProducto" th:value="${producto.idProducto}" />
                    <button type="submit">Eliminar</button>
                </form>
            </li>
        </ul>

        <!-- Modal  -->
        <div id="modalActualizar" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); border:1px solid black; padding:20px; background-color:white;">
            <h2>Actualizar Producto</h2>
            <form id="formActualizar" th:action="@{/productos/actualizar}" method="post">
                <input type="hidden" id="modalIdProducto" name="idProducto" />

                <label for="modalNombre">Nombre del producto</label>
                <input type="text" id="modalNombre" name="nombre" required>
                <br><br>

                <label for="modalPrecio">Precio</label>
                <input type="number" id="modalPrecio" name="precio" step="0.1" required>
                <br><br>

                <label for="modalStock">Stock</label>
                <input type="number" id="modalStock" name="stock" step="1" required>
                <br><br>

                <button type="submit">Confirmar Actualizaci√≥n</button>
                <button type="button" onclick="cerrarModalActualizar();">Cancelar</button>
            </form>
        </div>
		<!-- Codigo javascript para que funcione el modal  -->
        <script>
            function abrirModalActualizar(idProducto, nombre, precio, stock) {
                document.getElementById('modalIdProducto').value = idProducto;
                document.getElementById('modalNombre').value = nombre;
                document.getElementById('modalPrecio').value = precio;
                document.getElementById('modalStock').value = stock;
                document.getElementById('modalActualizar').style.display = 'block';
            }

            function cerrarModalActualizar() {
                document.getElementById('modalActualizar').style.display = 'none';
            }
        </script>
    </body>
</html>
